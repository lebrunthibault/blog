<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title> - Home</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Thibault Lebrun" /><meta name="description" content="Doc  Alembic tutorial  Commands  pipenv run alembic &amp;ndash;version pipenv run alembic init : creates the migration envirronment (meaning alembic/ package) alembic revision -m &amp;quot;create account table&amp;quot; : pour créer une migration alembic upgrade head (ou  &#43;1, &#43;2 ." /><meta name="keywords" content="" />






<meta name="generator" content="Hugo 0.93.2 with theme even" />


<link rel="canonical" href="https://lebrunthibault.github.io/post/backend-development/python/alembic/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.1289be4fc6296c288db4a9b805f568bb0a4e955787fe892dff9e3aba3afd6403.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="" />
<meta property="og:description" content="Doc  Alembic tutorial  Commands  pipenv run alembic &ndash;version pipenv run alembic init : creates the migration envirronment (meaning alembic/ package) alembic revision -m &quot;create account table&quot; : pour créer une migration alembic upgrade head (ou  &#43;1, &#43;2 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lebrunthibault.github.io/post/backend-development/python/alembic/" /><meta property="article:section" content="post" />

<meta property="article:modified_time" content="2022-05-10T00:26:05+02:00" />

<meta itemprop="name" content="">
<meta itemprop="description" content="Doc  Alembic tutorial  Commands  pipenv run alembic &ndash;version pipenv run alembic init : creates the migration envirronment (meaning alembic/ package) alembic revision -m &quot;create account table&quot; : pour créer une migration alembic upgrade head (ou  &#43;1, &#43;2 .">
<meta itemprop="dateModified" content="2022-05-10T00:26:05+02:00" />
<meta itemprop="wordCount" content="271">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="Doc  Alembic tutorial  Commands  pipenv run alembic &ndash;version pipenv run alembic init : creates the migration envirronment (meaning alembic/ package) alembic revision -m &quot;create account table&quot; : pour créer une migration alembic upgrade head (ou  &#43;1, &#43;2 ."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Home</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Home</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          




<article class="post">
    
    <header class="post-header">
        <h1 class="post-title"></h1>

        <div class="post-meta">
            
            <span class="more-meta"> 2 mins read </span> <br>
            <span class="date-info italic">Edited on 10.05.2022</span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#doc">Doc</a></li>
    <li><a href="#commands">Commands</a></li>
    <li><a href="#files">Files</a></li>
    <li><a href="#alembicini">Alembic.ini</a></li>
    <li><a href="#cookbook">Cookbook</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
        <h1 id="doc">Doc</h1>
<ul>
<li><a href="https://alembic.sqlalchemy.org/en/latest/tutorial.html">Alembic tutorial</a></li>
</ul>
<h1 id="commands">Commands</h1>
<ul>
<li>pipenv run alembic &ndash;version</li>
<li>pipenv run alembic init : creates the migration envirronment (meaning alembic/ package)</li>
<li><code>alembic revision -m &quot;create account table&quot;</code> : pour créer une migration</li>
<li><code>alembic upgrade head</code> (ou <revid> +1, +2 ..)</li>
<li>alembic downgrade &lt;rev_id&gt; (ou -1, -2) (ou base pour retourner au début)</li>
<li><code>alembic current</code> : view the current revision:</li>
</ul>
<p>Creating a new revision :</p>
<p>Another thing to notice is the <code>down_revision</code> variable. This is how Alembic knows the correct order in which to apply migrations. When we create the next revision, the new file’s <code>down_revision</code> identifier would point to this one</p>
<h1 id="files">Files</h1>
<ul>
<li>env.py : configure the sql alchemy connection. <em>The <code>env.py</code> script is part of the generated environment so that the way migrations run is entirely customizable</em></li>
<li><code>script.py.mako</code> - This is a <a href="http://www.makotemplates.org/">Mako</a> template file which is used to generate new migration scripts. Whatever is here is used to generate new files within <code>versions/</code>. This is scriptable so that the structure of each migration file can be</li>
<li><code>versions/</code> - This directory holds the individual version scripts. Users of other migration tools may notice that the files here don’t use ascending integers, and instead use a partial GUID approach. In Alembic, the ordering of version scripts is relative to directives within the scripts themselves, and it is theoretically possible to “splice” version files in between others, allowing migration sequences from different branches to be merged, albeit carefully by hand.</li>
<li><code>alembic.ini</code></li>
</ul>
<h1 id="alembicini">Alembic.ini</h1>
<ul>
<li>
<p>file_template: <a href="https://stackoverflow.com/questions/56306156/flask-migrate-make-migrations-in-alphabetical-order">See stack</a> If you really want to change naming convention you can do it by adding <code>file_template</code> field to your <code>alembic.in</code></p>
<p>e.g.: <code>file_template = %%(year)d%%(month).2d%%(day).2d_%%(hour).2d%%(minute).2d%%(second).2d_%%(rev)s_%%(slug)s</code></p>
</li>
</ul>
<h1 id="cookbook">Cookbook</h1>
<ul>
<li><a href="https://alembic.sqlalchemy.org/en/latest/cookbook.html#building-uptodate">Create and up to date database</a></li>
</ul>

    </div>

    
<footer class="post-footer">
        </footer>
</article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
    <a href="https://github.com/lebrunthibault" class="iconfont icon-github" title="github"></a>
    <a href="https://www.linkedin.com/in/thibault-lebrun/" class="iconfont icon-linkedin" title="linkedin"></a>
    <a href="mailto:thibaultlebrun@live.fr" class="iconfont icon-email" title="email"></a>
    <a href="https://lebrunthibault.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>


    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>

<link rel="stylesheet" href="/css/prism.css">
<script src="/js/prism.js"></script>



</body>
</html>
